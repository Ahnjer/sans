import streamlit as st
import random

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="í•­ì²´ ê²€ì‚¬ ì‹œë®¬ë ˆì´ì…˜",
    page_icon="ğŸ§¬",
    layout="wide"
)

# ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
if 'initialized' not in st.session_state:
    st.session_state.initialized = True
    is_a_infected = random.choice([True, False])
    st.session_state.experimental_status = {
        'A': {'infected': is_a_infected},
        'B': {'infected': not is_a_infected}
    }
    st.session_state.test_results = {}

# íƒ€ì´í‹€
st.title("ğŸ§¬ í•­ì²´ ê²€ì‚¬ ì‹œë®¬ë ˆì´ì…˜")
st.markdown("---")

# ì‹¤í—˜ ì„¤ëª…
st.info("**ì‹¤í—˜ ëª©í‘œ:** ì‹¤í—˜êµ°(ì‚¬ëŒ A, B)ì˜ ê°ì—¼ ì—¬ë¶€ë¥¼ í•­ì²´ ê²€ì‚¬ë¡œ í™•ì¸í•˜ì„¸ìš”. ëŒ€ì¡°êµ°(ì‚¬ëŒ C, D)ê³¼ ë¹„êµí•˜ì—¬ ê²°ê³¼ë¥¼ ë¶„ì„í•´ë³´ì„¸ìš”.")

# ìƒˆë¡œìš´ ì‹¤í—˜ ë²„íŠ¼
if st.button("ğŸ”„ ìƒˆë¡œìš´ ì‹¤í—˜ ì‹œì‘", type="primary"):
    is_a_infected = random.choice([True, False])
    st.session_state.experimental_status = {
        'A': {'infected': is_a_infected},
        'B': {'infected': not is_a_infected}
    }
    st.session_state.test_results = {}
    st.rerun()

st.markdown("---")

# ì‹¤í—˜êµ°
st.header("ğŸ‘¥ ì‹¤í—˜êµ° (Experimental Group) - ê°ì—¼ ì—¬ë¶€ ë¯¸í™•ì¸")

col1, col2 = st.columns(2)

with col1:
    with st.container(border=True):
        st.subheader("ğŸ©¸ ì‚¬ëŒ A")
        st.markdown("**ì‹¤í—˜êµ°** â“")
        
        if 'A' not in st.session_state.test_results:
            if st.button("ğŸ§ª í•­ì²´ ê²€ì‚¬ ì‹¤ì‹œ", key="test_A", use_container_width=True):
                st.session_state.test_results['A'] = st.session_state.experimental_status['A']['infected']
                st.rerun()
        else:
            result = st.session_state.test_results['A']
            if result:
                st.error("### ì–‘ì„± ë°˜ì‘ +", icon="ğŸ”´")
            else:
                st.success("### ìŒì„± ë°˜ì‘ -", icon="ğŸ”µ")
            
            # ëª¨ë“  ì‹¤í—˜êµ° ê²€ì‚¬ ì™„ë£Œ ì‹œ ì‹¤ì œ ìƒíƒœ ê³µê°œ
            if 'A' in st.session_state.test_results and 'B' in st.session_state.test_results:
                if st.session_state.experimental_status['A']['infected']:
                    st.warning("**ì‹¤ì œ ìƒíƒœ:** ê°ì—¼ë¨ ğŸ¦ ")
                else:
                    st.info("**ì‹¤ì œ ìƒíƒœ:** ë¬´ê°ì—¼ âœ“")

with col2:
    with st.container(border=True):
        st.subheader("ğŸ©¸ ì‚¬ëŒ B")
        st.markdown("**ì‹¤í—˜êµ°** â“")
        
        if 'B' not in st.session_state.test_results:
            if st.button("ğŸ§ª í•­ì²´ ê²€ì‚¬ ì‹¤ì‹œ", key="test_B", use_container_width=True):
                st.session_state.test_results['B'] = st.session_state.experimental_status['B']['infected']
                st.rerun()
        else:
            result = st.session_state.test_results['B']
            if result:
                st.error("### ì–‘ì„± ë°˜ì‘ +", icon="ğŸ”´")
            else:
                st.success("### ìŒì„± ë°˜ì‘ -", icon="ğŸ”µ")
            
            # ëª¨ë“  ì‹¤í—˜êµ° ê²€ì‚¬ ì™„ë£Œ ì‹œ ì‹¤ì œ ìƒíƒœ ê³µê°œ
            if 'A' in st.session_state.test_results and 'B' in st.session_state.test_results:
                if st.session_state.experimental_status['B']['infected']:
                    st.warning("**ì‹¤ì œ ìƒíƒœ:** ê°ì—¼ë¨ ğŸ¦ ")
                else:
                    st.info("**ì‹¤ì œ ìƒíƒœ:** ë¬´ê°ì—¼ âœ“")

st.markdown("---")

# ëŒ€ì¡°êµ°
st.header("ğŸ”¬ ëŒ€ì¡°êµ° (Control Group) - ê°ì—¼ ì—¬ë¶€ í™•ì¸ë¨")

col3, col4 = st.columns(2)

with col3:
    with st.container(border=True):
        st.subheader("ğŸ©¸ ì‚¬ëŒ C")
        st.success("**ê°ì—¼ë¨ (ì–‘ì„± ëŒ€ì¡°êµ°)**")
        
        if 'C' not in st.session_state.test_results:
            if st.button("ğŸ§ª í•­ì²´ ê²€ì‚¬ ì‹¤ì‹œ", key="test_C", use_container_width=True):
                st.session_state.test_results['C'] = True
                st.rerun()
        else:
            st.error("### ì–‘ì„± ë°˜ì‘ +", icon="ğŸ”´")

with col4:
    with st.container(border=True):
        st.subheader("ğŸ©¸ ì‚¬ëŒ D")
        st.info("**ë¬´ê°ì—¼ (ìŒì„± ëŒ€ì¡°êµ°)**")
        
        if 'D' not in st.session_state.test_results:
            if st.button("ğŸ§ª í•­ì²´ ê²€ì‚¬ ì‹¤ì‹œ", key="test_D", use_container_width=True):
                st.session_state.test_results['D'] = False
                st.rerun()
        else:
            st.success("### ìŒì„± ë°˜ì‘ -", icon="ğŸ”µ")

st.markdown("---")

# ì‹¤í—˜ ê²°ê³¼ ë¶„ì„ (ëª¨ë“  ì‹¤í—˜êµ° ê²€ì‚¬ ì™„ë£Œ ì‹œ)
if 'A' in st.session_state.test_results and 'B' in st.session_state.test_results:
    st.success("### âœ… ì‹¤í—˜ ê²°ê³¼ ë¶„ì„")
    
    with st.container(border=True):
        st.markdown("#### ğŸ”¬ ì‹¤í—˜êµ° ê²°ê³¼")
        col_a, col_b = st.columns(2)
        with col_a:
            st.write(f"**ì‚¬ëŒ A:** {'ì–‘ì„± (+)' if st.session_state.test_results['A'] else 'ìŒì„± (-)'} â†’ {'ê°ì—¼ë¨' if st.session_state.experimental_status['A']['infected'] else 'ë¬´ê°ì—¼'}")
        with col_b:
            st.write(f"**ì‚¬ëŒ B:** {'ì–‘ì„± (+)' if st.session_state.test_results['B'] else 'ìŒì„± (-)'} â†’ {'ê°ì—¼ë¨' if st.session_state.experimental_status['B']['infected'] else 'ë¬´ê°ì—¼'}")
    
    with st.container(border=True):
        st.markdown("#### âœ… ëŒ€ì¡°êµ°ê³¼ì˜ ë¹„êµ")
        st.write("â€¢ **ì–‘ì„± ëŒ€ì¡°êµ°(ì‚¬ëŒ C):** ê°ì—¼ëœ ì‚¬ëŒì˜ í˜ˆì•¡ìœ¼ë¡œ, í•­ì²´ê°€ ì¡´ì¬í•˜ì—¬ ì–‘ì„± ë°˜ì‘")
        st.write("â€¢ **ìŒì„± ëŒ€ì¡°êµ°(ì‚¬ëŒ D):** ë¬´ê°ì—¼ëœ ì‚¬ëŒì˜ í˜ˆì•¡ìœ¼ë¡œ, í•­ì²´ê°€ ì—†ì–´ ìŒì„± ë°˜ì‘")
        st.info("ğŸ’¡ ì‹¤í—˜êµ°ì˜ ê²°ê³¼ë¥¼ ëŒ€ì¡°êµ°ê³¼ ë¹„êµí•¨ìœ¼ë¡œì¨ ê²€ì‚¬ì˜ ì •í™•ì„±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
    
    with st.container(border=True):
        st.markdown("#### ğŸ’¡ í•µì‹¬ ì›ë¦¬")
        st.write("""
        í•­ì²´ ê²€ì‚¬ëŠ” ë©´ì—­ ì²´ê³„ê°€ ë³‘ì›ì²´ì— ë°˜ì‘í•˜ì—¬ ìƒì„±í•œ í•­ì²´ë¥¼ ê²€ì¶œí•©ë‹ˆë‹¤.
        ê°ì—¼ëœ ì‚¬ëŒì€ ì²´ë‚´ì— í•­ì²´ê°€ í˜•ì„±ë˜ì–´ ìˆì–´ ì–‘ì„± ë°˜ì‘ì„ ë³´ì´ê³ ,
        ê°ì—¼ë˜ì§€ ì•Šì€ ì‚¬ëŒì€ í•­ì²´ê°€ ì—†ì–´ ìŒì„± ë°˜ì‘ì„ ë³´ì…ë‹ˆë‹¤.
        """)

# ì‚¬ì´ë“œë°”ì— ì„¤ëª… ì¶”ê°€
with st.sidebar:
    st.header("ğŸ“š ì‹¤í—˜ ì„¤ê³„ì˜ ì¤‘ìš”ì„±")
    
    st.markdown("### ğŸ”µ ì‹¤í—˜êµ°")
    st.write("ê°ì—¼ ì—¬ë¶€ë¥¼ ì•Œì•„ë‚´ê³ ì í•˜ëŠ” ëŒ€ìƒ ê·¸ë£¹ì…ë‹ˆë‹¤. ì‚¬ëŒ Aì™€ B ì¤‘ í•œ ëª…ì€ ê°ì—¼ë˜ì—ˆê³  í•œ ëª…ì€ ë¬´ê°ì—¼ ìƒíƒœì…ë‹ˆë‹¤.")
    
    st.markdown("### ğŸŸ£ ëŒ€ì¡°êµ°")
    st.write("ë¹„êµ ê¸°ì¤€ì´ ë˜ëŠ” ê·¸ë£¹ì…ë‹ˆë‹¤. ì–‘ì„± ëŒ€ì¡°êµ°(C)ê³¼ ìŒì„± ëŒ€ì¡°êµ°(D)ì„ í†µí•´ ê²€ì‚¬ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
```

### ğŸ“ requirements.txt (ì´ ì½”ë“œë¥¼ ë³µì‚¬í•˜ì„¸ìš”)
```
streamlit
